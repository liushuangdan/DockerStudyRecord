## docker 学习笔记

一、docker 定义

 docker 是解决了运行环境和配置问题软件容器，方便做持续集成并有助于整体发布的容器虚拟化技术。

三、虚拟机技术

​        虚拟机就是带环境安装的一种解决方案。 它可以在一种操作系统里面运行另一种操作系统，比如在windows系统里运行Linux系统。应用程序对此毫无感知，因为虚拟机看上去跟真实系统一模一样，而对于底层系统来说，虚拟机就是一个普通文件，不需要了就删掉，对其他部分毫无影响。这类虚拟机完美的运行了另一套系统，能够使应用程序，操作系统和硬件之三者之间的逻辑不变。 

- 缺点： 1. 资源占用多 2. 冗余步骤多 3. 启动慢。【虚拟机的启动时分钟级别的， docker 的启动是秒级的】

三、docker 可以做什么

1. docker 应运而生

- 由于千每的虚拟机存在这些缺点，Linux发展出了另一种虚拟化技术：Linux 容器（Linux Containers， 缩写LXC） 

​        Linux 容器不是模拟一个完整的操作系统， 而是对进程进行隔离。有了容器，就可以将软件所需要的所有资源打包到一个隔离的容器中。容器与虚拟机不同，不需要捆绑一整套操作系统，只需要软件工程所需要的库资源和设置。系统因此而变得高效轻量并保证部署在任何环境中的软件都能始终如一地运行。 

比较了Docker和传统虚拟化方式的不同之处：

* 传统虚拟机技术是虚拟出一套硬件后， 在其上运行一个完整的操作系统，在该系统上再运行所需应用程序。
* 而容器内的应用程序直接运行于宿主的内核，容器内没有自己的内核，而且也没有进行硬件虚拟。因此容器要比传统虚拟机更为轻便。

2.  docker 对于开发/运维 DevOps  一次构建、随处运行

1. 更快捷的应用交付和部署
2. 更便捷的升级和扩缩容器
3. 更简单的系统运维
4. 更高效的计算资源利用

四、 why Docker

- 更轻量： 基于容器的虚拟化，仅包含业务运行所需的runtime环境，Centos/Ubuntu基础镜像仅170M；宿主机可部署100-1000个容器
- 更高效： 无操作系统虚拟化开销
  - 计算：轻量，无额外开销
  - 存储：系统盘aufs/dm/overlayfs：数据盘volume
  - 网络： 宿主机网络，NS隔离
- 更便捷、更灵活：
  - 分层的存储和包管理。 devops理念
  - 支持多种网络配置

五、docker 三要素 镜像 容器 仓库

六、 docker 的安装

1. Centos Docker 安装

   1. docker 支持一下的Centos版本：

      CentOS 7 （64-bit）

      CentOS6.5 （64-bit)或更高版本

2. 前提条件：

   目前， CentOS仅发行版本中的内核支持Docker。 

   Docker 运行在centos7 上， 要求系统为64位， 系统内核版本为3.10以上。

   Docker运行在Centos-6.5或者更高的版本的centos上，要求系统为64位，系统内核版本为2.6.32-431或者跟高版本。 

3. 查看服务器内核

   uname命令用于打印当前系统相关信息（内核版本号、硬件架构、机主名称和操作系统类型等）

   uname -r 【3.10.0-1062.18.1.el7.x86_64】

4.  查看centos 版本

   cat /etc/redhat-release  【CentOS Linux release 7.7.1908 (Core)】

七、docker 的架构图

	1. docker的基本组成 
	
	1. 镜像 images   
	
	   Docker 镜像（image）就是一个只读的模板， 镜像可以用来创建Docker容器，**一个镜像可以创建很多容器**。 
	
	   容器与镜像的关系类似于面向对象编程中的对象与类。
	
	   | Docker | 面向对象 |
	   | ------ | -------- |
	   | 容器   | 对象     |
	   | 镜像   | 类       |
	
	2.  容器 container 
	
	   Docker 利用容器（Container）独立运行的一个或一组应用。 **容器是用镜像创建的运行实例**。
	
	   它可以被启动、开始、停止、删除。 每个容器都是相互隔离的、保证安全的平台。
	
	   * 可以把容器看做事一个简易版的Linux环境（包括root用户权限、进程空间、用户空间和网络空间等）和运行在其中的应用程序。
	   * 容器的定义和镜像几乎一模一样，也是一堆层的统一视角，唯一区别在于容器的最上面那一层是可读可写的。 
	
	3.  仓库 repository
	
	   仓库（Repository)是集中存放镜像文件的场所。
	
	   仓库（Repository）和仓库注册服务器（Registry）是有区别的。仓库注册服务器上往往存放着多个仓库，每个仓库又包含了多个镜像，每个镜像有不同的标签（tag).
	
	   仓库分为公开仓库（Public）和私有仓库（Private）两种形式。
	
	   最大的公开仓库是Docker Hub（https://hub.docker.com/）
	
	   存放了数量庞大的镜像供用户下载。国内的公开仓库包括阿里云、网易云等


​       

    ##### 需要正确的理解仓库/镜像/容器这几个概念:
    
    Docker本身是一个容器运行载体或者称之为管理引擎。 我们把应用程序和配置依赖打包行成一个可交付的运行环境，这个打包好的运行环境就似乎images镜像文件。只有通过这个文件才能生成Docker容器。Image 文件可以懒作是容器的模板。 Docker根据images文件生成容器的实例。 同一个images文件，可以生成多个同时运行的容器实例。
    
    * image文件生成的容器实例，本身也是一个文件， 称为镜像文件。
    * 一个容器运行一种服务，当我们需要的时候，就可以通过docker客户端创建一个对应的运行实例，也就是我们的容器。
    * 至于仓库，就是放了一堆镜像的地方，我们可以把镜像发布到仓库中， 需要的时候从仓库中拉下来就可以了。 


​    

​    

​    

​    

​    

​    

​    

​    